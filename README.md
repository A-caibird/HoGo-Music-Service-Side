# 基于SpringBoot3的HoGo-Music服务器端开发
项目模式:前后端分离,前端采用vue3,端口5173,后端端口8080

## 开发指南

## 遇到的问题
### 前后端分离,跨域请求,导致session不一致
#### session简介
当从程序员的角度来看，会话（session）是一种在 Web 开发中经常使用的概念，用于跟踪用户在网站或应用中的活动状态。

在 Web 应用中，HTTP 协议是无状态的，这意味着服务器不能自动识别不同请求之间的关联。然而，很多应用需要在多个请求之间保持用户的状态，比如用户登录状态、购物车内容等。这时候就需要使用会话来跟踪和维护用户的状态。

会话的工作原理一般如下：

1. 客户端发起第一个请求到服务器，服务器接受该请求并生成一个唯一的会话标识符，通常称为会话 ID。
2. 服务器将会话 ID 发送给客户端，一般通过将会话 ID 存储在 Cookie 中，并在响应头中设置 Set-Cookie 字段。
3. 客户端接收到响应后，将会话 ID 存储在本地，通常存储在 Cookie 中。
4. 客户端发起后续的请求时，会将会话 ID 作为参数发送给服务器，通常是通过 Cookie 头部自动发送。
5. 服务器接收到请求后，通过会话 ID 可以找到对应的会话数据，从而恢复用户的状态信息。

在服务器端，会话数据一般存储在内存中或者持久化到数据库中。服务器可以根据会话 ID 快速检索和访问相应的会话数据，从而实现用户状态的跟踪和管理。

通过会话，开发人员可以实现以下功能：

1. 用户认证和授权：通过会话可以跟踪用户的登录状态，判断用户是否已经通过认证，并根据用户的权限控制对应的操作。
2. 购物车和订单管理：通过会话可以跟踪用户的购物车状态，将用户选择的商品添加到购物车中，并在结账时生成订单。
3. 数据共享：通过会话可以在多个请求之间共享数据，这对于需要在不同页面之间传递数据的场景非常有用。
4. 记录用户活动：通过会话可以跟踪用户的活动行为，例如用户在网站上的浏览记录、点击记录等，从而进行统计分析和个性化推荐。

需要注意的是，会话数据可能包含敏感信息，因此在设计和实现会话管理时需要注意安全性，比如使用加密算法保护会话数据，设置会话过期时间等。

总的来说，会话是一种在 Web 开发中用于跟踪和维护用户状态的机制，通过会话可以实现用户认证、数据共享和状态管理等功能。

#### 前后端分离项目背景下，跨域访问导致session一致性问题（是否同一用户)  
每次跨域调用接口，都会新建一个session信息，相当于每次调用都是不同用户访问，是不合理，更是不安全的设计。

#### 解决方法
1.前端设置 `axios.defaults.withCredentials = true;`

`axios.defaults.withCredentials = true;` 这行代码对于前后端分离项目非常重要，它的作用是启用跨域请求时携带凭据（如Cookies、身份验证头等）。
在默认情况下，浏览器在跨域请求中不会发送凭据信息，例如Cookies，以防止潜在的安全风险。这意味着当您的前端应用程序通过AJAX或Fetch API发送跨域请求时，不会发送任何与会话相关的凭据信息。

然而，在某些情况下，您可能需要在跨域请求中发送凭据，例如在前后端分离项目中进行用户身份验证。这时候，您需要将axios.defaults.withCredentials设置为true，以确保跨域请求携带凭据信息。
通过将`axios.defaults.withCredentials设置为true`，您告诉axios在发送请求时包括凭据信息，从而允许服务器验证用户的身份并处理相应的授权逻辑。

请注意，启用withCredentials会涉及到一些安全考虑，因为凭据信息可能会被传输到不同的域。因此，在使用此选项时，请确保您的服务器端正确配置了CORS（跨源资源共享）以限制允许接受凭据的来源。
总而言之，`axios.defaults.withCredentials = true;` 是确保跨域请求中携带凭据的关键设置，适用于需要在前后端分离项目中进行用户身份验证等场景。

2.后端controler添加注解
`@CrossOrigin(origins = "http://localhost:5173",allowCredentials = "true")`
不添加的报错信息:`Failed to load resource: Credentials flag is true, but Access-Control-Allow-Credentials is not "true".`
